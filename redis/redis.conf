# ==========================================
# REDIS CONFIGURATION FILE
# ==========================================

# Bind em todas as interfaces (necessário para acesso externo)
bind 0.0.0.0

# Porta padrão
port 6379

# ==========================================
# SEGURANÇA
# ==========================================

# Senha de autenticação (ALTERE ISSO!)
requirepass FmD145VtexDAMaa3Sipky

# Desabilitar comandos perigosos
rename-command FLUSHDB ""
rename-command FLUSHALL ""
rename-command CONFIG ""
rename-command SHUTDOWN ""
rename-command DEBUG ""

# Modo protegido (desabilitar apenas se necessário)
protected-mode yes

# ==========================================
# PERSISTÊNCIA
# ==========================================

# Habilitar AOF (Append Only File) para durabilidade
appendonly yes
appendfilename "appendonly.aof"
appendfsync everysec

# RDB Snapshots (backup automático)
save 900 1
save 300 10
save 60 10000

# Nome do arquivo RDB
dbfilename dump.rdb

# Diretório de dados
dir /data

# Compressão RDB
rdbcompression yes
rdbchecksum yes

# ==========================================
# MEMÓRIA
# ==========================================

# Limite máximo de memória (ajuste conforme necessário)
maxmemory 256mb

# Política de eviction quando atinge maxmemory
# allkeys-lru = remove chaves menos usadas (recomendado para cache)
# volatile-lru = remove apenas chaves com TTL
maxmemory-policy noeviction

# ==========================================
# PERFORMANCE
# ==========================================

# TCP backlog
tcp-backlog 511

# Timeout de cliente inativo (0 = desabilitado)
timeout 300

# TCP keepalive
tcp-keepalive 300

# Número de databases
databases 16

# ==========================================
# LOGS
# ==========================================

# Nível de log: debug, verbose, notice, warning
loglevel notice

# Arquivo de log (vazio = stdout)
logfile ""

# ==========================================
# SLOW LOG
# ==========================================

# Log de comandos lentos (em microsegundos)
slowlog-log-slower-than 10000
slowlog-max-len 128

# ==========================================
# LATÊNCIA
# ==========================================

# Monitoramento de latência
latency-monitor-threshold 100

# ==========================================
# CLUSTER/REPLICAÇÃO (se necessário)
# ==========================================

# Descomente se for usar replicação
# replicaof <masterip> <masterport>
# masterauth <master-password>

# ==========================================
# OUTROS
# ==========================================

# Sempre mostrar logo
always-show-logo yes

# Notificações de eventos de keyspace (desabilitado por padrão)
notify-keyspace-events ""
